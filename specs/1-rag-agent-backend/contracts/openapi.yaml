openapi: 3.0.0
info:
  title: RAG Agent API
  description: API for RAG-enabled agent using OpenAI SDK with Google Gemini
  version: 1.0.0
servers:
  - url: http://localhost:8000
    description: Development server
paths:
  /query:
    post:
      summary: Submit a query to the RAG agent
      description: Process a user query through the RAG system with context from Qdrant
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QueryRequest'
      responses:
        '200':
          description: Successful response from the agent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/QueryResponse'
        '400':
          description: Bad request - invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
components:
  schemas:
    QueryRequest:
      type: object
      required:
        - query
      properties:
        query:
          type: string
          description: The user's query text
          example: "What is the main concept of ROS 2?"
        top_k:
          type: integer
          description: Number of documents to retrieve (default: 5)
          minimum: 1
          maximum: 20
          example: 5
        threshold:
          type: number
          description: Minimum similarity score threshold (default: 0.7)
          minimum: 0.0
          maximum: 1.0
          example: 0.7
        include_sources:
          type: boolean
          description: Whether to include source information in response (default: true)
          example: true
    QueryResponse:
      type: object
      required:
        - answer
        - sources
        - processing_time
      properties:
        answer:
          type: string
          description: The agent's answer to the query
          example: "ROS 2 (Robot Operating System 2) is a flexible framework for writing robot software..."
        sources:
          type: array
          description: Source documents referenced in the response
          items:
            type: string
          example: ["https://tayyabahussain98.github.io/hackathon_1-physical_ai_humanoid_robotics_textbook/docs/module1/1-1-introduction-to-ros2"]
        retrieved_documents:
          type: array
          description: Documents retrieved during the process
          items:
            $ref: '#/components/schemas/RetrievedDocument'
        processing_time:
          type: number
          description: Time taken to process the request in seconds
          example: 2.45
    RetrievedDocument:
      type: object
      required:
        - content
        - similarity_score
        - source_url
      properties:
        content:
          type: string
          description: The content of the retrieved document
          example: "ROS 2 is a flexible framework for writing robot software..."
        similarity_score:
          type: number
          description: Similarity score of the document to the query
          minimum: 0.0
          maximum: 1.0
          example: 0.85
        source_url:
          type: string
          description: URL of the source document
          example: "https://tayyabahussain98.github.io/hackathon_1-physical_ai_humanoid_robotics_textbook/docs/module1/1-1-introduction-to-ros2"
        title:
          type: string
          description: Title of the source document
          example: "Introduction to ROS 2 | Physical AI & Humanoid Robotics"
    ErrorResponse:
      type: object
      required:
        - error
      properties:
        error:
          type: string
          description: Error message
          example: "Invalid query format"